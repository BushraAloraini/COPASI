# Original Author was Kalle@kde.org
# I lifted it in some mater. (Stephan Kulow)
# I used much code from Janos Farkas

dnl Process this file with autoconf to produce a configure script.

AC_INIT(acinclude.m4) dnl a source file from your sub dir

dnl This is so we can use kde-common
AC_CONFIG_AUX_DIR(admin)

dnl Perform program name transformation
AC_ARG_PROGRAM

dnl Automake doc recommends to do this only here. (Janos)
AM_INIT_AUTOMAKE(copasi,0.1)

dnl make /usr/local the default for the installation
AC_PREFIX_DEFAULT(/usr/local)

if test "x$prefix" = "xNONE"; then
  prefix=$ac_default_prefix
  ac_configure_args="$ac_configure_args --prefix $prefix"
fi

if test x"${enable_release}" != x"yes" -a x"${enable_debug}" != x"no"; then
  cps_release="CONFIG+=debug"
else
  cps_release="CONFIG+=release"
fi

if test x"${enable_thread}" != x"no"; then
  cps_thread="CONFIG+=thread"
else
  cps_thread="CONFIG-=thread"
fi

if test x"${MKL_PATH}" != x""; then
  cps_mkl_path="MKL_PATH=$MKL_PATH"
fi

if test x"${CLAPACK_PATH}" != x""; then
  cps_clapack_path="CLAPACK_PATH=$CLAPACK_PATH"
fi

if test x"${EXPAT_PATH}" != x""; then
  cps_expat_path="EXPAT_PATH=$EXPAT_PATH"
fi


(
dnl to prevent calling aclocal, automake and configure again
 touch aclocal.m4 
 touch configure.in
 touch Makefile.in
 touch configure

 cd copasi && \
 echo executing in `pwd`: && \
 echo "  rm .qmake.internal.cache */.qmake.internal.cache" && \
 rm .qmake.internal.cache */.qmake.internal.cache; \
 echo "  qmake $cps_release $cps_mkl_path $cps_thread $cps_clapack_path $cps_expat_path" && \
 $QTDIR/bin/qmake $cps_release $cps_thread \
                  $cps_mkl_path $cps_clapack_path $cps_expat_path && \
 cat Makefile | \
 sed -e 's/(MAKEFILE): *$/(MAKEFILE): Makefile/' \
     -e 'sxQMAKE.*=.*qmakexQMAKE = \$(QTDIR)/bin/qmakex'> $$.tmp && \
 mv $$.tmp Makefile \
)

dnl add here all your Makefiles. These will be created by configure
AC_OUTPUT(Makefile)
